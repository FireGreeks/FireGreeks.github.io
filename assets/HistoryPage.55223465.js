import{r,k as _,_ as P,$ as w,a0 as u,a7 as o,a1 as c,a3 as p,a6 as k,u as Y}from"./index.7495bed7.js";import{Q as q}from"./QTable.196461ff.js";import{Q as x}from"./QPage.90e15c34.js";import{u as D}from"./index.bd525f96.js";import{d as m}from"./date.075048db.js";import{u as M}from"./use-quasar.b310abda.js";import{p as T}from"./index.1946058e.js";import"./use-checkbox.da97e191.js";import"./format.419deab4.js";import"./QList.ed99d05b.js";import"./use-timeout.952a5886.js";const $={class:"page-container"},Q=o("h2",{class:"text-center"},"Travel History",-1),B=o("h5",{class:"subtitle text-center"},"All previous travels",-1),H=o("br",null,null,-1),N=o("p",null,"On this page, you have access to all previously submitted travels along with their relevant information. Whether you're looking to review past trips, analyze travel patterns, or assess the environmental impact of your journeys, this comprehensive archive provides you with the data you need. ",-1),R=o("p",null,[o("b",null,"Tips"),p(": You can sort ascending or descending by date.")],-1),J={__name:"HistoryPage",setup(C){const g=M(),{result:F,loading:f,error:V,refetch:v}=D(T(`
    query getHistory ($page: Int!, $count: Int!, $descending: Boolean!) {
      travelHistory(page: $page, count: $count, descending: $descending) {
        date
        startPoint { coordinates, label }
        endPoint { coordinates, label }
        distance
        emission
      },
      overallStats {
        totalTravels
      }
    }
  `),{page:0,count:3,descending:!1}),b=[{name:"date",required:!0,label:"Date & Time",align:"left",field:e=>e.date,format:e=>m.formatDate(m.extractDate(e,"YYYY-MM-DD"),g.platform.is.mobile?"DD/MM/YY":"Do MMMM YYYY"),sortable:!0},{name:"start",label:"From",field:"startPoint",format:e=>e.label},{name:"start",label:"To",field:"endPoint",format:e=>e.label},{name:"distance",label:"Distance (km)",field:"distance",format:e=>e.toFixed(2)+"km"},{name:"emission",label:"CO2 Emission (kg)",field:"emission",format:e=>e.toFixed(2)+"kg"}],h=r(),i=r([]),y=r(""),t=r({page:1,rowsPerPage:3,rowsNumber:10,descending:!0,sortBy:"date"});function n(e){const{page:a,rowsPerPage:s,descending:l}=e.pagination;v({page:a,count:s,descending:l}).then(d=>{i.value=d.data.travelHistory,t.value.page=a,t.value.rowsPerPage=s,t.value.descending=l,t.value.rowsNumber=d.data.overallStats.totalTravels})}return _(()=>{n({pagination:{page:1,rowsPerPage:3,descending:!0}})}),(e,a)=>(P(),w(x,{class:"q-pa-md"},{default:u(()=>[o("div",$,[Q,B,H,N,R,c(k,{onClick:a[0]||(a[0]=s=>n({pagination:{page:1,rowsPerPage:t.value.rowsPerPage}})),class:"bg-primary q-mt-sm q-mb-sm"},{default:u(()=>[p(" Refresh data ")]),_:1}),c(q,{flat:"",bordered:"",ref_key:"tableRef",ref:h,title:"Last Travels",rows:i.value,columns:b,"row-key":"id",pagination:t.value,"onUpdate:pagination":a[1]||(a[1]=s=>t.value=s),loading:Y(f).value,filter:y.value,"binary-state-sort":"",onRequest:n},null,8,["rows","pagination","loading","filter"])])]),_:1}))}};export{J as default};
