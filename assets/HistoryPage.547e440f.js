import{m as j,c as g,l as f,K as E,g as ee,N as de,O as F,F as ve,P as me,S as W,T as K,W as te,x as X,X as G,r as N,w as Z,n as pe,ae as fe,cu as ge,aW as he,k as ce,a as _e,Y as ye,cv as be,a6 as L,A as xe,d as we,_ as M,$ as z,a0 as S,a7 as w,a1 as I,a3 as B,aa as ne,ab as ae,ac as oe,v as Pe,cd as Ce,u as qe,a4 as H,Q as ke,bw as Se,bv as Te}from"./index.3c3289c5.js";import{g as re,s as ie}from"./touch.3df10340.js";import{c as Ie,d as $e,f as Ae}from"./format.f8bc4694.js";import{u as Be}from"./use-render-cache.1a7235d4.js";import{u as De,a as Me,b as Ne,Q as Ee}from"./QTable.a0a7d445.js";import{Q as Ve}from"./QPage.a5861a35.js";import{u as Qe}from"./index.c0ba34e6.js";import{d as le}from"./date.b9fc3567.js";import{u as Ye}from"./use-quasar.99f00ec8.js";import{_ as Fe}from"./plugin-vue_export-helper.21dcd24c.js";import{p as He}from"./index.7402cf17.js";import"./use-checkbox.b6d5ef1c.js";import"./QList.9a047c8c.js";import"./use-timeout.4676a119.js";var J=j({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(e,{slots:o}){const u=ee(),m=g(()=>"q-td"+(e.autoWidth===!0?" q-table--col-auto-width":"")+(e.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(e.props===void 0)return f("td",{class:m.value},E(o.default));const r=u.vnode.key,t=(e.props.colsMap!==void 0?e.props.colsMap[r]:null)||e.props.col;if(t===void 0)return;const{row:a}=e.props;return f("td",{class:m.value+t.__tdClass(a),style:t.__tdStyle(a)},E(o.default))}}}),se=j({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:o}){const u=g(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>f("tr",{class:u.value},E(o.default))}});function Le(e){const o=[.06,6,50];return typeof e=="string"&&e.length&&e.split(":").forEach((u,m)=>{const r=parseFloat(u);r&&(o[m]=r)}),o}var Re=de({name:"touch-swipe",beforeMount(e,{value:o,arg:u,modifiers:m}){if(m.mouse!==!0&&F.has.touch!==!0)return;const r=m.mouseCapture===!0?"Capture":"",t={handler:o,sensitivity:Le(u),direction:re(m),noop:ve,mouseStart(a){ie(a,t)&&me(a)&&(W(t,"temp",[[document,"mousemove","move",`notPassive${r}`],[document,"mouseup","end","notPassiveCapture"]]),t.start(a,!0))},touchStart(a){if(ie(a,t)){const p=a.target;W(t,"temp",[[p,"touchmove","move","notPassiveCapture"],[p,"touchcancel","end","notPassiveCapture"],[p,"touchend","end","notPassiveCapture"]]),t.start(a)}},start(a,p){F.is.firefox===!0&&K(e,!0);const P=te(a);t.event={x:P.left,y:P.top,time:Date.now(),mouse:p===!0,dir:!1}},move(a){if(t.event===void 0)return;if(t.event.dir!==!1){X(a);return}const p=Date.now()-t.event.time;if(p===0)return;const P=te(a),q=P.left-t.event.x,l=Math.abs(q),b=P.top-t.event.y,d=Math.abs(b);if(t.event.mouse!==!0){if(l<t.sensitivity[1]&&d<t.sensitivity[1]){t.end(a);return}}else if(window.getSelection().toString()!==""){t.end(a);return}else if(l<t.sensitivity[2]&&d<t.sensitivity[2])return;const y=l/p,k=d/p;t.direction.vertical===!0&&l<d&&l<100&&k>t.sensitivity[0]&&(t.event.dir=b<0?"up":"down"),t.direction.horizontal===!0&&l>d&&d<100&&y>t.sensitivity[0]&&(t.event.dir=q<0?"left":"right"),t.direction.up===!0&&l<d&&b<0&&l<100&&k>t.sensitivity[0]&&(t.event.dir="up"),t.direction.down===!0&&l<d&&b>0&&l<100&&k>t.sensitivity[0]&&(t.event.dir="down"),t.direction.left===!0&&l>d&&q<0&&d<100&&y>t.sensitivity[0]&&(t.event.dir="left"),t.direction.right===!0&&l>d&&q>0&&d<100&&y>t.sensitivity[0]&&(t.event.dir="right"),t.event.dir!==!1?(X(a),t.event.mouse===!0&&(document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Ie(),t.styleCleanup=i=>{t.styleCleanup=void 0,document.body.classList.remove("non-selectable");const h=()=>{document.body.classList.remove("no-pointer-events--children")};i===!0?setTimeout(h,50):h()}),t.handler({evt:a,touch:t.event.mouse!==!0,mouse:t.event.mouse,direction:t.event.dir,duration:p,distance:{x:l,y:d}})):t.end(a)},end(a){t.event!==void 0&&(G(t,"temp"),F.is.firefox===!0&&K(e,!1),t.styleCleanup!==void 0&&t.styleCleanup(!0),a!==void 0&&t.event.dir!==!1&&X(a),t.event=void 0)}};if(e.__qtouchswipe=t,m.mouse===!0){const a=m.mouseCapture===!0||m.mousecapture===!0?"Capture":"";W(t,"main",[[e,"mousedown","mouseStart",`passive${a}`]])}F.has.touch===!0&&W(t,"main",[[e,"touchstart","touchStart",`passive${m.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,o){const u=e.__qtouchswipe;u!==void 0&&(o.oldValue!==o.value&&(typeof o.value!="function"&&u.end(),u.handler=o.value),u.direction=re(o.modifiers))},beforeUnmount(e){const o=e.__qtouchswipe;o!==void 0&&(G(o,"main"),G(o,"temp"),F.is.firefox===!0&&K(e,!1),o.styleCleanup!==void 0&&o.styleCleanup(),delete e.__qtouchswipe)}});const Oe={name:{required:!0},disable:Boolean},ue={setup(e,{slots:o}){return()=>f("div",{class:"q-panel scroll",role:"tabpanel"},E(o.default))}},Ue={modelValue:{required:!0},animated:Boolean,infinite:Boolean,swipeable:Boolean,vertical:Boolean,transitionPrev:String,transitionNext:String,transitionDuration:{type:[String,Number],default:300},keepAlive:Boolean,keepAliveInclude:[String,Array,RegExp],keepAliveExclude:[String,Array,RegExp],keepAliveMax:Number},We=["update:modelValue","beforeTransition","transition"];function ze(){const{props:e,emit:o,proxy:u}=ee(),{getCache:m}=Be();let r,t;const a=N(null),p=N(null);function P(n){const c=e.vertical===!0?"up":"left";T((u.$q.lang.rtl===!0?-1:1)*(n.direction===c?1:-1))}const q=g(()=>[[Re,P,void 0,{horizontal:e.vertical!==!0,vertical:e.vertical,mouse:!0}]]),l=g(()=>e.transitionPrev||`slide-${e.vertical===!0?"down":"right"}`),b=g(()=>e.transitionNext||`slide-${e.vertical===!0?"up":"left"}`),d=g(()=>`--q-transition-duration: ${e.transitionDuration}ms`),y=g(()=>typeof e.modelValue=="string"||typeof e.modelValue=="number"?e.modelValue:String(e.modelValue)),k=g(()=>({include:e.keepAliveInclude,exclude:e.keepAliveExclude,max:e.keepAliveMax})),i=g(()=>e.keepAliveInclude!==void 0||e.keepAliveExclude!==void 0);Z(()=>e.modelValue,(n,c)=>{const C=x(n)===!0?V(n):-1;t!==!0&&D(C===-1?0:C<V(c)?-1:1),a.value!==C&&(a.value=C,o("beforeTransition",n,c),pe(()=>{o("transition",n,c)}))});function h(){T(1)}function s(){T(-1)}function v(n){o("update:modelValue",n)}function x(n){return n!=null&&n!==""}function V(n){return r.findIndex(c=>c.props.name===n&&c.props.disable!==""&&c.props.disable!==!0)}function O(){return r.filter(n=>n.props.disable!==""&&n.props.disable!==!0)}function D(n){const c=n!==0&&e.animated===!0&&a.value!==-1?"q-transition--"+(n===-1?l.value:b.value):null;p.value!==c&&(p.value=c)}function T(n,c=a.value){let C=c+n;for(;C!==-1&&C<r.length;){const A=r[C];if(A!==void 0&&A.props.disable!==""&&A.props.disable!==!0){D(n),t=!0,o("update:modelValue",A.props.name),setTimeout(()=>{t=!1});return}C+=n}e.infinite===!0&&r.length!==0&&c!==-1&&c!==r.length&&T(n,n===-1?r.length:-1)}function Q(){const n=V(e.modelValue);return a.value!==n&&(a.value=n),!0}function U(){const n=x(e.modelValue)===!0&&Q()&&r[a.value];return e.keepAlive===!0?[f(he,k.value,[f(i.value===!0?m(y.value,()=>({...ue,name:y.value})):ue,{key:y.value,style:d.value},()=>n)])]:[f("div",{class:"q-panel scroll",style:d.value,key:y.value,role:"tabpanel"},[n])]}function _(){if(r.length!==0)return e.animated===!0?[f(fe,{name:p.value},U)]:U()}function $(n){return r=ge(E(n.default,[])).filter(c=>c.props!==null&&c.props.slot===void 0&&x(c.props.name)===!0),r.length}function Y(){return r}return Object.assign(u,{next:h,previous:s,goTo:v}),{panelIndex:a,panelDirectives:q,updatePanelsList:$,updatePanelIndex:Q,getPanelContent:_,getEnabledPanels:O,getPanels:Y,isValidPanelName:x,keepAliveProps:k,needsUniqueKeepAliveWrapper:i,goToPanelByOffset:T,goToPanel:v,nextPanel:h,previousPanel:s}}var je=j({name:"QCarouselSlide",props:{...Oe,imgSrc:String},setup(e,{slots:o}){const u=g(()=>e.imgSrc?{backgroundImage:`url("${e.imgSrc}")`}:{});return()=>f("div",{class:"q-carousel__slide",style:u.value},E(o.default))}});const Ke=["top","right","bottom","left"],Xe=["regular","flat","outline","push","unelevated"];var Ge=j({name:"QCarousel",props:{...$e,...Ue,...De,transitionPrev:{type:String,default:"fade"},transitionNext:{type:String,default:"fade"},height:String,padding:Boolean,controlColor:String,controlTextColor:String,controlType:{type:String,validator:e=>Xe.includes(e),default:"flat"},autoplay:[Number,Boolean],arrows:Boolean,prevIcon:String,nextIcon:String,navigation:Boolean,navigationPosition:{type:String,validator:e=>Ke.includes(e)},navigationIcon:String,navigationActiveIcon:String,thumbnails:Boolean},emits:[...Me,...We],setup(e,{slots:o}){const{proxy:{$q:u}}=ee(),m=Ae(e,u);let r=null,t;const{updatePanelsList:a,getPanelContent:p,panelDirectives:P,goToPanel:q,previousPanel:l,nextPanel:b,getEnabledPanels:d,panelIndex:y}=ze(),{inFullscreen:k}=Ne(),i=g(()=>k.value!==!0&&e.height!==void 0?{height:e.height}:{}),h=g(()=>e.vertical===!0?"vertical":"horizontal"),s=g(()=>`q-carousel q-panel-parent q-carousel--with${e.padding===!0?"":"out"}-padding`+(k.value===!0?" fullscreen":"")+(m.value===!0?" q-carousel--dark q-dark":"")+(e.arrows===!0?` q-carousel--arrows-${h.value}`:"")+(e.navigation===!0?` q-carousel--navigation-${O.value}`:"")),v=g(()=>{const _=[e.prevIcon||u.iconSet.carousel[e.vertical===!0?"up":"left"],e.nextIcon||u.iconSet.carousel[e.vertical===!0?"down":"right"]];return e.vertical===!1&&u.lang.rtl===!0?_.reverse():_}),x=g(()=>e.navigationIcon||u.iconSet.carousel.navigationIcon),V=g(()=>e.navigationActiveIcon||x.value),O=g(()=>e.navigationPosition||(e.vertical===!0?"right":"bottom")),D=g(()=>({color:e.controlColor,textColor:e.controlTextColor,round:!0,[e.controlType]:!0,dense:!0}));Z(()=>e.modelValue,()=>{e.autoplay&&T()}),Z(()=>e.autoplay,_=>{_?T():r!==null&&(clearTimeout(r),r=null)});function T(){const _=be(e.autoplay)===!0?Math.abs(e.autoplay):5e3;r!==null&&clearTimeout(r),r=setTimeout(()=>{r=null,_>=0?b():l()},_)}ce(()=>{e.autoplay&&T()}),_e(()=>{r!==null&&clearTimeout(r)});function Q(_,$){return f("div",{class:`q-carousel__control q-carousel__navigation no-wrap absolute flex q-carousel__navigation--${_} q-carousel__navigation--${O.value}`+(e.controlColor!==void 0?` text-${e.controlColor}`:"")},[f("div",{class:"q-carousel__navigation-inner flex flex-center no-wrap"},d().map($))])}function U(){const _=[];if(e.navigation===!0){const $=o["navigation-icon"]!==void 0?o["navigation-icon"]:n=>f(L,{key:"nav"+n.name,class:`q-carousel__navigation-icon q-carousel__navigation-icon--${n.active===!0?"":"in"}active`,...n.btnProps,onClick:n.onClick}),Y=t-1;_.push(Q("buttons",(n,c)=>{const C=n.props.name,A=y.value===c;return $({index:c,maxIndex:Y,name:C,active:A,btnProps:{icon:A===!0?V.value:x.value,size:"sm",...D.value},onClick:()=>{q(C)}})}))}else if(e.thumbnails===!0){const $=e.controlColor!==void 0?` text-${e.controlColor}`:"";_.push(Q("thumbnails",Y=>{const n=Y.props;return f("img",{key:"tmb#"+n.name,class:`q-carousel__thumbnail q-carousel__thumbnail--${n.name===e.modelValue?"":"in"}active`+$,src:n.imgSrc||n["img-src"],onClick:()=>{q(n.name)}})}))}return e.arrows===!0&&y.value>=0&&((e.infinite===!0||y.value>0)&&_.push(f("div",{key:"prev",class:`q-carousel__control q-carousel__arrow q-carousel__prev-arrow q-carousel__prev-arrow--${h.value} absolute flex flex-center`},[f(L,{icon:v.value[0],...D.value,onClick:l})])),(e.infinite===!0||y.value<t-1)&&_.push(f("div",{key:"next",class:`q-carousel__control q-carousel__arrow q-carousel__next-arrow q-carousel__next-arrow--${h.value} absolute flex flex-center`},[f(L,{icon:v.value[1],...D.value,onClick:b})]))),xe(o.control,_)}return()=>(t=a(o),f("div",{class:s.value,style:i.value},[ye("div",{class:"q-carousel__slides-container"},p(),"sl-cont",e.swipeable,()=>P.value)].concat(U())))}});const R=e=>(Se("data-v-f208327c"),e=e(),Te(),e),Je={class:"page-container"},Ze=R(()=>w("h2",{class:"text-center"},"Travel History",-1)),et=R(()=>w("h5",{class:"subtitle text-center"},"All previous travels",-1)),tt=R(()=>w("br",null,null,-1)),nt=R(()=>w("p",null,"On this page, you have access to all previously submitted travels along with their relevant information. Whether you're looking to review past trips, analyze travel patterns, or assess the environmental impact of your journeys, this comprehensive archive provides you with the data you need. ",-1)),at=R(()=>w("p",null,[w("b",null,"Tips"),B(": You can sort ascending or descending by date.")],-1)),ot={class:"row inline q-ml-sm items-center"},rt={class:"column no-wrap q-pa-sm",style:{width:"200px"}},it={class:"data"},lt={class:"data"},st={__name:"HistoryPage",setup(e){const o=Ye(),{result:u,loading:m,error:r,refetch:t}=Qe(He(`
    query getHistory ($page: Int!, $count: Int!, $descending: Boolean!) {
      travelHistory(page: $page, count: $count, descending: $descending) {
        id
        date
        start { coordinates, label }
        end { coordinates, label }
        distance
        emission
        stops {
          previousPoint { label }
          point { label }
          travelMethod
          distance
          emission
        }
      },
      overallStats {
        totalTravels
      }
    }
  `),{page:0,count:3,descending:!1}),a=[{name:"expand",label:"",field:"expand"},{name:"date",required:!0,label:"Date & Time",align:"left",field:i=>i.date,format:i=>le.formatDate(le.extractDate(i,"YYYY-MM-DD"),o.platform.is.mobile?"DD/MM/YY":"Do MMMM YYYY"),sortable:!0},{name:"start",label:"From",field:"start",format:i=>i.label},{name:"destination",label:"To",field:"end",format:i=>i.label},{name:"distance",label:"Distance (km)",field:"distance",format:i=>i.toFixed(2)+"km"},{name:"emission",label:"CO2 Emission (kg)",field:"emission",format:i=>i.toFixed(2)+"kg"}],p=N(),P=N([]),q=N(""),l=N({page:1,rowsPerPage:3,rowsNumber:10,descending:!0,sortBy:"date"});function b(i){const{page:h,rowsPerPage:s,descending:v}=i.pagination;t({page:h,count:s,descending:v}).then(x=>{P.value=x.data.travelHistory,l.value.page=h,l.value.rowsPerPage=s,l.value.descending=v,l.value.rowsNumber=x.data.overallStats.totalTravels})}const d=we({});function y(i){i.expand=!i.expand,d[i.rowIndex*i.pageIndex]="0"}function k(i){switch(i){case"AIRPLANE":return"flight_takeoff";case"BICYCLE":return"pedal_bike";case"BUS":return"airport_shuttle";case"TRAIN":case"SUBWAY":return"train";default:return"transportation"}}return ce(()=>{b({pagination:{page:1,rowsPerPage:3,descending:!0}})}),(i,h)=>(M(),z(Ve,{class:"q-pa-md"},{default:S(()=>[w("div",Je,[Ze,et,tt,nt,at,I(L,{onClick:h[0]||(h[0]=s=>b({pagination:{page:1,rowsPerPage:l.value.rowsPerPage}})),class:"bg-primary q-mt-sm q-mb-sm"},{default:S(()=>[B(" Refresh data ")]),_:1}),I(Ee,{flat:"",bordered:"",ref_key:"tableRef",ref:p,title:"Last Travels",rows:P.value,columns:a,"row-key":"id",pagination:l.value,"onUpdate:pagination":h[1]||(h[1]=s=>l.value=s),loading:qe(m).value,filter:q.value,"binary-state-sort":"",onRequest:b},{body:S(s=>[(M(),z(se,{props:s,key:`m_${s.row.index}`,onClick:v=>y(s)},{default:S(()=>[I(J,{"auto-width":""},{default:S(()=>[I(L,{dense:"",round:"",flat:"",icon:s.expand?"arrow_drop_up":"arrow_drop_down"},null,8,["icon"])]),_:2},1024),(M(!0),ne(oe,null,ae(s.cols.slice(1,s.cols.length),v=>(M(),z(J,{key:v.name,props:s},{default:S(()=>[B(H(v.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props","onClick"])),Pe(I(se,{props:s},{default:S(()=>[I(J,{colspan:"100%"},{default:S(()=>[I(Ge,{modelValue:d[s.rowIndex*s.pageIndex],"onUpdate:modelValue":v=>d[s.rowIndex*s.pageIndex]=v,"transition-prev":"scale","transition-next":"scale",swipeable:"",animated:"","control-color":"black",arrows:"",padding:"",height:"70px",class:"no-wrap rounded-borders"},{default:S(()=>[(M(!0),ne(oe,null,ae(s.row.stops,(v,x)=>(M(),z(je,{key:x,name:x.toString(),class:"row no-wrap items-center justify-between"},{default:S(()=>[w("div",ot,[B(H(v.previousPoint.label)+" ",1),I(ke,{name:k(v.travelMethod),class:"q-ma-md"},null,8,["name"]),B(" "+H(v.point.label),1)]),w("div",rt,[w("div",null,[B("Distance: "),w("span",it,H(v.distance.toFixed(2))+" km",1)]),w("div",null,[B("Emission: "),w("span",lt,H(v.emission.toFixed(2))+" kg",1)])])]),_:2},1032,["name"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["props"]),[[Ce,s.expand]])]),_:1},8,["rows","pagination","loading","filter"])])]),_:1}))}};var Pt=Fe(st,[["__scopeId","data-v-f208327c"]]);export{Pt as default};
