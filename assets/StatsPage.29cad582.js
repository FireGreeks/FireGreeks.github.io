import{Q as V}from"./scroll.73d60827.js";import{Q as de}from"./QCard.6a5fd305.js";import{S as Z,v as le,y as l,aD as ce,b0 as me,aK as re,r as y,T as w,x as j,t as ve,aU as fe,b1 as ge,U as he,ab as X,ao as be,B as ee,s as pe,J as xe,C as W,L as G,M as B,a9 as r,aa as ye,E as I,O as E,aV as J,H as h,F as te,aW as Se,G as ae,b2 as _e,b3 as we}from"./index.3a0f0796.js";import{u as Te,a as ke,b as Ie,f as Ee,Q as oe}from"./use-prevent-scroll.2bb50834.js";import{Q as ne,u as Ce,a as Me,b as Oe}from"./use-checkbox.abed8f07.js";import{u as Le,a as qe}from"./use-dark.6fa81c01.js";import{k as De}from"./use-key-composition.26151a7d.js";import{u as Qe}from"./uid.42677368.js";import{Q as Ae}from"./QSelect.bd47761d.js";import{Q as $e}from"./QPage.cb3dd9a8.js";import{d as U}from"./date.22e01349.js";import{d as ie}from"./typesFormatter.fa832516.js";import{s as se,a as Be}from"./GQL.1bffc6c6.js";import{_ as Re}from"./plugin-vue_export-helper.21dcd24c.js";import"./format.f8305c8d.js";var He=Z({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(e,{slots:C,emit:T}){let v=!1,u,i,d=null,b=null,S,M;function p(){u&&u(),u=null,v=!1,d!==null&&(clearTimeout(d),d=null),b!==null&&(clearTimeout(b),b=null),i!==void 0&&i.removeEventListener("transitionend",S),S=null}function f(a,g,x){g!==void 0&&(a.style.height=`${g}px`),a.style.transition=`height ${e.duration}ms cubic-bezier(.25, .8, .50, 1)`,v=!0,u=x}function _(a,g){a.style.overflowY=null,a.style.height=null,a.style.transition=null,p(),g!==M&&T(g)}function D(a,g){let x=0;i=a,v===!0?(p(),x=a.offsetHeight===a.scrollHeight?0:void 0):(M="hide",a.style.overflowY="hidden"),f(a,x,g),d=setTimeout(()=>{d=null,a.style.height=`${a.scrollHeight}px`,S=c=>{b=null,(Object(c)!==c||c.target===a)&&_(a,"show")},a.addEventListener("transitionend",S),b=setTimeout(S,e.duration*1.1)},100)}function Q(a,g){let x;i=a,v===!0?p():(M="show",a.style.overflowY="hidden",x=a.scrollHeight),f(a,x,g),d=setTimeout(()=>{d=null,a.style.height=0,S=c=>{b=null,(Object(c)!==c||c.target===a)&&_(a,"hide")},a.addEventListener("transitionend",S),b=setTimeout(S,e.duration*1.1)},100)}return le(()=>{v===!0&&p()}),()=>l(ce,{css:!1,appear:e.appear,onEnter:D,onLeave:Q},C.default)}});const q=me({}),Ye=Object.keys(re);var Ne=Z({name:"QExpansionItem",props:{...re,...Te,...Le,icon:String,label:String,labelLines:[Number,String],caption:String,captionLines:[Number,String],dense:Boolean,toggleAriaLabel:String,expandIcon:String,expandedIcon:String,expandIconClass:[Array,String,Object],duration:Number,headerInsetLevel:Number,contentInsetLevel:Number,expandSeparator:Boolean,defaultOpened:Boolean,hideExpandIcon:Boolean,expandIconToggle:Boolean,switchToggleSide:Boolean,denseToggle:Boolean,group:String,popup:Boolean,headerStyle:[Array,String,Object],headerClass:[Array,String,Object]},emits:[...ke,"click","afterShow","afterHide"],setup(e,{slots:C,emit:T}){const{proxy:{$q:v}}=ve(),u=qe(e,v),i=y(e.modelValue!==null?e.modelValue:e.defaultOpened),d=y(null),b=De(),{show:S,hide:M,toggle:p}=Ie({showing:i});let f,_;const D=w(()=>`q-expansion-item q-item-type q-expansion-item--${i.value===!0?"expanded":"collapsed"} q-expansion-item--${e.popup===!0?"popup":"standard"}`),Q=w(()=>{if(e.contentInsetLevel===void 0)return null;const t=v.lang.rtl===!0?"Right":"Left";return{["padding"+t]:e.contentInsetLevel*56+"px"}}),a=w(()=>e.disable!==!0&&(e.href!==void 0||e.to!==void 0&&e.to!==null&&e.to!=="")),g=w(()=>{const t={};return Ye.forEach(O=>{t[O]=e[O]}),t}),x=w(()=>a.value===!0||e.expandIconToggle!==!0),c=w(()=>e.expandedIcon!==void 0&&i.value===!0?e.expandedIcon:e.expandIcon||v.iconSet.expansionItem[e.denseToggle===!0?"denseIcon":"icon"]),H=w(()=>e.disable!==!0&&(a.value===!0||e.expandIconToggle===!0)),L=w(()=>({expanded:i.value===!0,detailsId:b.value,toggle:p,show:S,hide:M})),Y=w(()=>{const t=e.toggleAriaLabel!==void 0?e.toggleAriaLabel:v.lang.label[i.value===!0?"collapse":"expand"](e.label);return{role:"button","aria-expanded":i.value===!0?"true":"false","aria-controls":b.value,"aria-label":t}});j(()=>e.group,t=>{_!==void 0&&_(),t!==void 0&&m()});function z(t){a.value!==!0&&p(t),T("click",t)}function P(t){t.keyCode===13&&o(t,!0)}function o(t,O){O!==!0&&d.value!==null&&d.value.focus(),p(t),be(t)}function n(){T("afterShow")}function s(){T("afterHide")}function m(){f===void 0&&(f=Qe()),i.value===!0&&(q[e.group]=f);const t=j(i,F=>{F===!0?q[e.group]=f:q[e.group]===f&&delete q[e.group]}),O=j(()=>q[e.group],(F,ue)=>{ue===f&&F!==void 0&&F!==f&&M()});_=()=>{t(),O(),q[e.group]===f&&delete q[e.group],_=void 0}}function A(){const t={class:[`q-focusable relative-position cursor-pointer${e.denseToggle===!0&&e.switchToggleSide===!0?" items-end":""}`,e.expandIconClass],side:e.switchToggleSide!==!0,avatar:e.switchToggleSide},O=[l(X,{class:"q-expansion-item__toggle-icon"+(e.expandedIcon===void 0&&i.value===!0?" q-expansion-item__toggle-icon--rotated":""),name:c.value})];return H.value===!0&&(Object.assign(t,{tabindex:0,...Y.value,onClick:o,onKeyup:P}),O.unshift(l("div",{ref:d,class:"q-expansion-item__toggle-focus q-icon q-focus-helper q-focus-helper--rounded",tabindex:-1}))),l(V,t,()=>O)}function k(){let t;return C.header!==void 0?t=[].concat(C.header(L.value)):(t=[l(V,()=>[l(oe,{lines:e.labelLines},()=>e.label||""),e.caption?l(oe,{lines:e.captionLines,caption:!0},()=>e.caption):null])],e.icon&&t[e.switchToggleSide===!0?"push":"unshift"](l(V,{side:e.switchToggleSide===!0,avatar:e.switchToggleSide!==!0},()=>l(X,{name:e.icon})))),e.disable!==!0&&e.hideExpandIcon!==!0&&t[e.switchToggleSide===!0?"unshift":"push"](A()),t}function N(){const t={ref:"item",style:e.headerStyle,class:e.headerClass,dark:u.value,disable:e.disable,dense:e.dense,insetLevel:e.headerInsetLevel};return x.value===!0&&(t.clickable=!0,t.onClick=z,Object.assign(t,a.value===!0?g.value:Y.value)),l(Ee,t,k)}function $(){return fe(l("div",{key:"e-content",class:"q-expansion-item__content relative-position",style:Q.value,id:b.value},he(C.default)),[[ge,i.value]])}function K(){const t=[N(),l(He,{duration:e.duration,onShow:n,onHide:s},$)];return e.expandSeparator===!0&&t.push(l(ne,{class:"q-expansion-item__border q-expansion-item__border--top absolute-top",dark:u.value}),l(ne,{class:"q-expansion-item__border q-expansion-item__border--bottom absolute-bottom",dark:u.value})),t}return e.group!==void 0&&m(),le(()=>{_!==void 0&&_()}),()=>l("div",{class:D.value},[l("div",{class:"q-expansion-item__container relative-position"},K())])}}),Ve=Z({name:"QToggle",props:{...Ce,icon:String,iconColor:String},emits:Me,setup(e){function C(T,v){const u=w(()=>(T.value===!0?e.checkedIcon:v.value===!0?e.indeterminateIcon:e.uncheckedIcon)||e.icon),i=w(()=>T.value===!0?e.iconColor:null);return()=>[l("div",{class:"q-toggle__track"}),l("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},u.value!==void 0?[l(X,{name:u.value,color:i.value})]:void 0)]}return Oe("toggle",C)}});const R=e=>(_e("data-v-5e695a49"),e=e(),we(),e),Pe=R(()=>r("h2",{class:"text-center"},"My Dashboard",-1)),Fe=R(()=>r("h5",{class:"subtitle text-center"},"All the stats you will ever need",-1)),Ue=R(()=>r("br",null,null,-1)),ze={class:"page-container"},Ke=R(()=>r("p",null,[E("On this page, you will find every statistic relevant to your recorded travel emissions. Whether it's the "),r("b",null,"carbon footprint"),E(" of your "),r("i",null,"flights"),E(", the impact of your "),r("i",null,"daily commute,"),E(" or the emissions generated by your "),r("i",null,"road trips"),E(", this comprehensive collection of data aims to provide you with a detailed overview of your "),r("b",null,"environmental impact"),E(" from travel. By presenting these statistics in one centralized location, you can gain valuable insights into your carbon footprint, allowing you to make informed decisions and take steps towards reducing your environmental footprint.")],-1)),je=R(()=>r("div",{style:{width:"25%"}},null,-1)),We={style:{width:"75%"}},Ge=R(()=>r("br",null,null,-1)),Je={class:"row",style:{width:"100%"}},Xe={__name:"StatsPage",setup(e){const C=ee(`
    query getStats ($unit: TimeUnit, $delta: Int!, $separateMethods: Boolean!) {
      stats(unit: $unit, delta: $delta) {
        labels
        emissions(separateMethods: $separateMethods) {
          name
          data
        }
        distances(separateMethods: false) {
          name
          data
        }
      }
    }
  `),T=ee(`
    query overallStats {
      overallStats {
        totalEmission
        totalDistance
        totalTravels

        methodsUsed
        methodDistribution
        emissionDistribution
      }
    }`),{refetch:v}=se(C,{unit:"WEEK",delta:0,separateMethods:!0}),{loading:u,error:i,result:d,onResult:b,refetch:S}=se(T),M=y({}),p=y([]),f=y({}),_=y([]),D=y({}),Q=y({}),a=y([]),g=y([]),x=y(0),c=y("WEEK"),H=y(!0);b(o=>{if(o.loading)return;const n=s=>({pie:{donut:{labels:{show:!0,total:{show:!0,fontFamily:"Helvetica, Arial, sans-serif",fontSize:"15px",label:"Total",formatter:function(m){return s(m.globals.seriesTotals.reduce((A,k)=>A+k,0))}},value:{show:!0,fontSize:"25px",fontFamily:"Anton, Arial, sans-serif",offsetY:0}}}}});Q.value={labels:o.data.overallStats.methodsUsed.map(ie),title:{text:"Overall Emission Distribution (kg)",align:"left",style:{fontSize:"18px"}},plotOptions:n(s=>s.toFixed(2))},D.value={labels:o.data.overallStats.methodsUsed.map(ie),title:{text:"Overall Method Distribution (km)",align:"left",style:{fontSize:"18px"}},plotOptions:n(s=>Math.floor(s))},g.value=o.data.overallStats.emissionDistribution,a.value=o.data.overallStats.methodDistribution});function L(){Be(v,{unit:c.value,delta:x.value,separateMethods:H.value}).then(o=>{let n=[100];o.data.stats.emissions.length!==0&&(n=o.data.stats.emissions[0].data.map((k,N)=>o.data.stats.emissions.reduce(($,K)=>$+K.data[N],0)));const s=z(o.data.stats.labels[0],c.value),m=0,A=Math.max(...n);M.value={chart:{id:"stats",stacked:!0},xaxis:{categories:o.data.stats.labels.map(k=>Y(k,c.value))},yaxis:[{title:{text:"Distance (km)"},decimalsInFloat:0},{opposite:!0,min:m,max:A,decimalsInFloat:2,title:{text:"Emission (kg)"}},...new Array(10).fill({show:!1,min:m,max:A})],stroke:{curve:"straight",width:[4,...new Array(50).fill(0)]},dataLabels:{enabled:!1},title:{text:"CO2 Emission and Distance Travelled ("+s+")",align:"left",style:{fontSize:"18px"}}},f.value={chart:{id:"stats_ratio"},xaxis:{categories:o.data.stats.labels.map(k=>Y(k,c.value))},yaxis:[{title:{text:"Ratio (g/km)"},decimalsInFloat:2}],stroke:{curve:"straight",width:4},dataLabels:{enabled:!1},title:{text:"CO2 Emission per km ("+s+")",align:"left",style:{fontSize:"18px"}}},p.value=[],o.data.stats.distances.length!==0&&p.value.push(...P(o.data.stats.distances,"line")),o.data.stats.emissions.length!==0&&(p.value.push(...P(o.data.stats.emissions,"column")),_.value=[{name:"Ratio",data:n.map((k,N)=>{const $=o.data.stats.distances[0].data[N];return $===0?0:k/$})}])})}function Y(o,n){let s;switch(n){case"WEEK":s="ddd DD/MM";break;case"MONTH":s="DD";break;case"YEAR":s="MMMM";break}return U.formatDate(o,s)}function z(o,n){switch(n){case"WEEK":return"Week "+U.formatDate(o,"ww");case"MONTH":return U.formatDate(o,"MMMM YYYY");case"YEAR":return U.formatDate(o,"YYYY")}}function P(o,n){return o.map(s=>({...s,type:n}))}return pe(()=>{S(),L()}),(o,n)=>{const s=xe("apexchart");return W(),G($e,{class:"q-pa-sm"},{default:B(()=>[Pe,Fe,Ue,r("div",ze,[Ke,r("div",{class:"highlight-box",style:ye("width: "+(o.$q.platform.is.mobile?"100%":"75%"))},[I(Ne,null,{header:B(()=>[I(V,{id:"number",avatar:""},{default:B(()=>[E(J(h(u)?"0.00":h(d).overallStats.totalEmission.toFixed(2))+"kg ",1)]),_:1}),I(V,null,{default:B(()=>[E(" of CO2 have been emitted by your transports. ")]),_:1})]),default:B(()=>[I(de,{class:"bg-secondary row"},{default:B(()=>[je,r("div",We,[E(" This information is the total of CO2 emission that has been recorded over your total of "),r("b",null,J(h(u)||h(i)?"0":h(d).overallStats.totalTravels)+" travels",1),E("; and over a distance of "),r("b",null,J(h(u)||h(i)?"0":h(d).overallStats.totalDistance.toFixed(2))+"km.",1)])]),_:1})]),_:1})],4),Ge,r("div",Je,[I(Ae,{class:"col",filled:"",modelValue:c.value,"onUpdate:modelValue":[n[0]||(n[0]=m=>c.value=m),n[1]||(n[1]=m=>L())],options:["WEEK","MONTH","YEAR"],label:"Time Unit","stack-label":""},null,8,["modelValue"]),I(te,{icon:"arrow_left",onClick:n[2]||(n[2]=m=>{x.value++,L()})}),I(te,{icon:"arrow_right",onClick:n[3]||(n[3]=m=>{x.value--,L()})}),I(Ve,{modelValue:H.value,"onUpdate:modelValue":[n[4]||(n[4]=m=>H.value=m),n[5]||(n[5]=m=>L())],color:"green",label:"Travel Methods"},null,8,["modelValue"])]),I(s,{type:"bar",options:M.value,series:p.value},null,8,["options","series"]),I(s,{type:"line",options:f.value,series:_.value},null,8,["options","series"]),r("div",{class:Se(!o.$q.platform.is.mobile&&"row")},[h(u)||h(i)||h(d).overallStats.totalEmission===0?ae("",!0):(W(),G(s,{key:0,class:"col",type:"donut",options:Q.value,series:g.value},null,8,["options","series"])),h(u)||h(i)||h(d).overallStats.totalDistance===0?ae("",!0):(W(),G(s,{key:1,class:"col",type:"donut",options:D.value,series:a.value},null,8,["options","series"]))],2)])]),_:1})}}};var ft=Re(Xe,[["__scopeId","data-v-5e695a49"]]);export{ft as default};
